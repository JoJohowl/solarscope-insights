{% extends 'base.html' %}

{% block title %}Visualisation | SolarAnalytics{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto px-6 py-10 space-y-8">
  <h2 class="text-3xl font-bold text-[var(--primary-color)]">Data Visualisation</h2>
  <p class="text-gray-700 text-base">Select datasets to visualise and compare solar exposure trends.</p>

  <!-- Dataset dropdowns -->
  <div class="space-y-6">
    <div>
      <label for="dataset-select-1" class="block text-lg font-medium mb-2">Choose a dataset:</label>
      <select id="dataset-select-1" class="w-full p-2 rounded-md border border-gray-300 focus:ring focus:ring-blue-300">
        <option value="" disabled selected>Select a city</option>
        {% for file in uploaded_files %}
        <option value="{{ file.id }}">{{ file.city }}</option>
        {% endfor %}
      </select>
    </div>

    <div id="dataset-select-2-wrapper" class="hidden">
      <label for="dataset-select-2" class="block text-lg font-medium mb-2">Compare with another dataset:</label>
      <select id="dataset-select-2" class="w-full p-2 rounded-md border border-gray-300 focus:ring focus:ring-blue-300">
        <option value="" disabled selected>Select a city</option>
        {% for file in uploaded_files %}
        <option value="{{ file.id }}">{{ file.city }}</option>
        {% endfor %}
      </select>
    </div>
  </div>

  <!-- Add another city toggle -->
  <div class="flex items-center mt-2">
    <input type="checkbox" id="add-city-checkbox" class="mr-2">
    <label for="add-city-checkbox" class="text-base font-medium">Add another city</label>
  </div>

  <!-- Visualise button -->
  <div>
    <button id="visualize-datasets"
            class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg shadow-sm transition">
      Visualise
    </button>
  </div>

  <!-- Chart container -->
  <div>
    <canvas id="solarChart" width="800" height="400" class="mx-auto"></canvas>
  </div>

  <!-- Export buttons -->
  <div class="flex flex-wrap gap-4 justify-start">
    <button id="export-pdf"
            class="bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded-lg shadow-sm transition">
      Export as PDF
    </button>
    <button id="export-image"
            class="bg-blue-500 hover:bg-blue-600 text-white px-5 py-2 rounded-lg shadow-sm transition">
      Export as PNG/JPG
    </button>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.9/dist/chart.umd.min.js"></script>
<script src="{{ url_for('static', filename='js/script.js') }}"></script>
{% endblock %}
