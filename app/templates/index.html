{% extends 'base.html' %} {% block title %}Your Uploaded Files{% endblock %} {%
block content %}
<h1>Your Uploaded Files</h1>
<p><a href="{{ url_for('main.upload') }}" class="btn">Upload New CSV</a></p>

{% if files %}
<table>
  <thead>
    <tr>
      <th>Filename</th>
      <th>City</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Uploaded At</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for file in files %} {% set saved_name = file.filepath.split('/')[-1] %}
    <tr>
      <td>{{ file.filename }}</td>
      <td>{{ file.city }}</td>
      <td>{{ '%.6f'|format(file.latitude) }}</td>
      <td>{{ '%.6f'|format(file.longitude) }}</td>
      <td>{{ file.uploaded_at.strftime('%Y-%m-%d %H:%M') }}</td>
      <td style="display: flex; gap: 0.5rem">
        <a href="{{ url_for('main.view_file', file_id=file.id) }}" class="btn"
          >View</a
        >
        <a
          href="{{ url_for('main.delete_file', file_id=file.id) }}"
          class="btn"
          style="background: #dc2626; border: none"
          onclick="return confirm('Are you sure you want to delete {{ file.filename }}?');"
        >
          Delete
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
<p>No files uploaded yet.</p>
{% endif %} {% endblock %}
